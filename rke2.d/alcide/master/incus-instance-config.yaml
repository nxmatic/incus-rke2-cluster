# incus instance config (@codebase)
name: master
architecture: aarch64
profiles:
  - rke2lab
config:
  raw.lxc: |
    lxc.cap.drop =
    lxc.apparmor.profile = unconfined
    lxc.mount.auto = proc:rw sys:rw cgroup-full:rw
    lxc.cgroup.devices.allow = c *:* rwm
    lxc.cgroup.devices.allow = b *:* rwm
  security.privileged: true
  security.nesting: true
  volatile.lan0.hwaddr: 10:66:6a:4c:01:00
  volatile.vmnet0.hwaddr: 52:54:00:01:00:00
devices:
  kmsg.dev:
    type: unix-char
    source: /dev/kmsg
    path: /dev/kmsg
  zfs.dev:
    type: unix-char
    source: /dev/zfs
    path: /dev/zfs
  secrets.file:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/.local.d/var/private/incus/secrets
    path: /srv/host/.secrets
  rke2lab.env.file:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/rke2.d/alcide/master/environment
    path: /srv/host/environment
  rke2lab.scripts.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/make.d/incus/scripts
    path: /srv/host/scripts.d
  rke2lab.system.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/make.d/incus/systemd
    path: /srv/host/system.d
  manifests.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/rke2.d/alcide/master/manifests.d
    path: /srv/host/manifests.d
  rke2.config.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/.local.d/var/lib/kpt/alcide/master/runtime/rke2-config/configmaps
    path: /srv/host/config.d
  shared.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/.local.d/share
    path: /srv/host/share.d
  kubeconfig.dir:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/.local.d/var/kube
    path: /srv/host/kubeconfig.d
  user.metadata:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/rke2.d/alcide/master/meta-data
    path: /var/lib/cloud/seed/nocloud/meta-data
  user.user-data:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/rke2.d/alcide/master/user-data
    path: /var/lib/cloud/seed/nocloud/user-data
  user.network-config:
    type: disk
    source: /net/alcide.local/private/var/lib/git/nxmatic/rke2lab/rke2.d/alcide/master/network-config
    path: /var/lib/cloud/seed/nocloud/network-config
